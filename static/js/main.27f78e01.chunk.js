(this["webpackJsonpspotify-search"]=this["webpackJsonpspotify-search"]||[]).push([[0],{29:function(e,t,c){},30:function(e,t,c){},38:function(e,t,c){"use strict";c.r(t);var r=c(1),a=c.n(r),n=c(21),s=c.n(n),i=(c(29),c(30),c(16)),o=c(2),l=c(0),u=function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"/spotify-search",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AUTHORIZE_URL:"https://accounts.spotify.com/authorize",REACT_APP_REDIRECT_URL:"https://danield770.github.io/spotify-search/callback",REACT_APP_CLIENT_ID:"405281f84e1b47808864d0cbf83a9c1e"}),t=e.REACT_APP_CLIENT_ID,c=e.REACT_APP_AUTHORIZE_URL,r=e.REACT_APP_REDIRECT_URL;console.log("client id: ",t),console.log("authorize url: ",c),console.log("redirect url: ",r);return Object(l.jsxs)("div",{className:"login",children:[Object(l.jsx)("h1",{className:"search-header",children:"We first need to login to Spotify"}),Object(l.jsx)("button",{className:"btn--primary",type:"submit",onClick:function(){window.location="".concat(c,"?client_id=").concat(t,"&redirect_uri=").concat(r,"&response_type=token&show_dialog=true")},children:"Login"})]})},j=c(8),d=function(e){return e.map((function(e){var t=e.id,c=e.name,r=e.track_number,a=e.popularity,n=e.preview_url,s=e.album,i=e.artists;return{id:t,name:c,track_number:r,popularity:a,preview_url:n,album_img:s.images[0].url,release_date:s.release_date,artist_name:i[0].name}}))},b=function(){var e=Object(o.g)(),t=Object(o.f)();return Object(r.useEffect)((function(){!e.hash&&t.push("/search");var c=e.hash.slice(1).split("&").reduce((function(e,t){var c=t.split("="),r=Object(j.a)(c,2),a=r[0],n=r[1];return e[a]=n,e}),{}),r=Date.now()+1e3*c.expires_in;localStorage.setItem("params",JSON.stringify(c)),localStorage.setItem("expiry_time",r),t.push("/spotify-search/search")}),[]),null},h=c(18),m=c.n(h),p=c(19),O=c(13),f=c(24),x=function(){return Object(l.jsxs)("h1",{className:"search-header sticky",children:[Object(l.jsxs)("span",{"aria-hidden":"true",children:["Sp",Object(l.jsx)("span",{className:"icon-logo",children:"o"}),"tify"]}),Object(l.jsx)("span",{className:"offscreen",children:"Spotify"}),Object(l.jsx)("span",{className:"icon-search",children:"Search"})]})},_=c(12),v=function(e){var t=e.onFormSubmit,c=e.onSort,a=Object(r.useRef)(),n=(new Date).getFullYear(),s=function(e){var r=e.target,n=r.value;if(console.log("selected: ",r.name,n),"sort"===r.name)c(n);else{var s=Object(_.a)({text:a.current.value},r.name,n);t(s)}};return Object(l.jsxs)("form",{className:"form sticky",onSubmit:function(e){e.preventDefault();var c={text:a.current.value};t(c)},children:[Object(l.jsxs)("div",{className:"form__search-wpr",children:[Object(l.jsx)("input",{className:"form__input",type:"text",placeholder:"Search album or artist",ref:a}),Object(l.jsx)("button",{className:"form__btn",children:"Search"})]}),Object(l.jsxs)("div",{className:"form__sort-wpr",children:[Object(l.jsx)("label",{htmlFor:"form__sort",children:"Sort By:"}),Object(l.jsxs)("select",{id:"form__sort",name:"sort",onChange:s,children:[Object(l.jsx)("option",{value:"",children:"Default"}),Object(l.jsx)("option",{value:"name",children:"Album name"}),Object(l.jsx)("option",{value:"artist_name",children:"Artist name"}),Object(l.jsx)("option",{value:"release_date",children:"Release Date"}),Object(l.jsx)("option",{value:"popularity",children:"Popularity"})]})]}),Object(l.jsxs)("div",{className:"form__filter-wpr",children:[Object(l.jsx)("label",{htmlFor:"form__filter",children:"Filter By:"}),Object(l.jsxs)("select",{id:"form__filter",name:"filter",onChange:s,children:[Object(l.jsx)("option",{value:"",children:"Any time"}),Object(l.jsx)("option",{value:n,children:"Past year"}),Object(l.jsx)("option",{value:"".concat(n-1,"-").concat(n),children:"Past 2 years"}),Object(l.jsx)("option",{value:"".concat(n-4,"-").concat(n),children:"Past 5 years"})]})]})]})},g=function(e){var t,c,r,a=e.data,n=e.sortBy,s=e.isLoading,i=e.onFetchMore,o=["popularity","release_date"].includes(n);return Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{className:"albums-count sticky",children:[a.total," Results found"]}),Object(l.jsxs)("ul",{className:"albums",children:[console.log("data: ",a),(t=a.items,c=n,r=o,t.slice().sort((function(e,t){var a=e[c],n=t[c];return r?a>n?-1:a<n?1:0:a<n?-1:a>n?1:0}))).map((function(e){var t=e.id,c=e.name,r=e.track_number,a=e.popularity,n=e.preview_url,s=e.release_date,i=e.artist_name,o=e.album_img;return Object(l.jsxs)("li",{className:"album",children:[Object(l.jsx)("img",{className:"album__img",alt:c,loading:"lazy",src:o}),Object(l.jsxs)("audio",{className:"album__audio",controls:!0,src:n,children:["Your browser does not support the",Object(l.jsx)("code",{children:"audio"})," element."]}),Object(l.jsxs)("dl",{className:"album__content",children:[Object(l.jsxs)("div",{children:[Object(l.jsx)("dt",{children:"Artist name"}),Object(l.jsx)("dd",{children:i})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("dt",{children:"Album Name"}),Object(l.jsx)("dd",{children:c}),Object(l.jsxs)("dd",{className:"album__track",children:["track #",r]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("dt",{children:"Release Date"}),Object(l.jsx)("dd",{children:s})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("dt",{children:"Popularity"}),Object(l.jsx)("dd",{children:a})]})]})]},t)}))]}),null!==a.next&&Object(l.jsx)("button",{className:"btn--primary ".concat(s?"loading":""),type:"button",onClick:function(){i(a.next)},children:"Load more albums"})]})},y=function(){var e,t,c,a=Object(r.useState)(""),n=Object(j.a)(a,2),s=n[0],i=n[1],o=Object(r.useState)({}),u=Object(j.a)(o,2),b=u[0],h=u[1],_=Object(r.useState)(""),y=Object(j.a)(_,2),S=y[0],k=y[1],N=Object(r.useState)(!1),R=Object(j.a)(N,2),E=R[0],A=R[1];Object(r.useEffect)((function(){if(s){var e=JSON.parse(localStorage.getItem("params")).access_token;console.log("token",e);var t={"Content-Type":"application/json",Authorization:"Bearer ".concat(e)};console.log("url: ",s),function(){var e=Object(f.a)(m.a.mark((function e(){var c,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.next=3,fetch(s,{headers:t});case 3:return c=e.sent,e.next=6,c.json();case 6:if(r=e.sent,A(!1),console.log("setting data...",r),void 0===r.error){e.next=12;break}return h(r),e.abrupt("return");case 12:h((function(e){return 0===r.tracks.offset?{href:r.tracks.href,total:r.tracks.total,next:r.tracks.next,previous:r.tracks.previous,items:Object(O.a)(d(r.tracks.items))}:Object(p.a)(Object(p.a)({},e),{},{next:r.tracks.next,items:[].concat(Object(O.a)(e.items),Object(O.a)(d(r.tracks.items)))})}));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}}),[s]);return Object(l.jsxs)("main",{className:"app ".concat((null===b||void 0===b||null===(e=b.items)||void 0===e?void 0:e.length)>0?"has-data":""),children:[Object(l.jsx)(x,{}),Object(l.jsx)(v,{onFormSubmit:function(e){var t,c=e.filter?"+year:".concat(e.filter):"",r="https://api.spotify.com/v1/search?query=".concat(function(e){return e.replaceAll(" ","+")}((t=e.text,decodeURIComponent(JSON.parse('"'+t.replace(/"/g,'\\"')+'"'))))).concat(c,"&type=track&market=US");console.log("url: ",r),S&&k(S),i(r)},onSort:function(e){k(e)}}),(null===b||void 0===b||null===(t=b.items)||void 0===t?void 0:t.length)>0&&Object(l.jsx)(g,{data:b,sortBy:S,isLoading:E,onFetchMore:function(e){i(e)}}),b.error&&Object(l.jsxs)("p",{className:"error",children:["It looks like there was a ",(null===(c=b.error)||void 0===c?void 0:c.status)||"",' network error... since: "',b.error.message,'"']}),E&&Object(l.jsx)("div",{className:"loading",children:"Loading..."})]})},S=function(){return Object(l.jsx)("div",{children:Object(l.jsx)(i.a,{children:Object(l.jsxs)(o.c,{children:[Object(l.jsx)(o.a,{path:"/spotify-search/callback",children:Object(l.jsx)(b,{})}),Object(l.jsx)(o.a,{path:"/spotify-search/search",children:Object(l.jsx)(y,{})}),Object(l.jsx)(o.a,{path:"/spotify-search/",children:Object(l.jsx)(u,{})})]})})})},k=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,39)).then((function(t){var c=t.getCLS,r=t.getFID,a=t.getFCP,n=t.getLCP,s=t.getTTFB;c(e),r(e),a(e),n(e),s(e)}))};s.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(S,{})}),document.getElementById("root")),k()}},[[38,1,2]]]);
//# sourceMappingURL=main.27f78e01.chunk.js.map