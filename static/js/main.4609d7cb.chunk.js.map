{"version":3,"sources":["components/SearchForm.js","utils/helper.js","components/Results.js","App.js","reportWebVitals.js","index.js"],"names":["SearchForm","onFormSubmit","onSort","inputRef","useRef","currentYear","Date","getFullYear","handleChange","e","target","value","console","log","name","input","text","current","className","onSubmit","preventDefault","type","placeholder","ref","htmlFor","id","onChange","chooseRelevantItemData","items","map","track_number","popularity","preview_url","album","artists","album_img","images","url","release_date","artist_name","Results","array","key","isReversed","data","sortBy","isLoading","onFetchMore","isReverseSort","includes","error","status","message","length","total","slice","sort","a","b","x","y","alt","loading","src","controls","next","onClick","App","token","Cookies","get","useState","setUrl","setData","setSortBy","setIsLoading","useEffect","headers","Authorization","fetch","res","json","undefined","prev","tracks","offset","href","previous","getData","aria-hidden","str","yearRange","filter","replaceAll","encodeSpaces","decodeURIComponent","JSON","parse","replace","redirectUri","clientID","process","scopes","Scopes","userReadPrivate","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4609d7cb.chunk.js","sourcesContent":["import React, { useRef } from 'react';\n\nconst SearchForm = ({ onFormSubmit, onSort }) => {\n  const inputRef = useRef();\n  const currentYear = new Date().getFullYear();\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    const input = { text: inputRef.current.value };\n    onFormSubmit(input);\n  };\n  const handleChange = (e) => {\n    const target = e.target;\n    const value = target.value;\n    console.log('selected: ', target.name, value);\n    if (target.name === 'sort') {\n      onSort(value);\n    } else {\n      const input = { text: inputRef.current.value, [target.name]: value };\n      onFormSubmit(input);\n    }\n  };\n  return (\n    <form className='form sticky' onSubmit={handleSubmit}>\n      <div className='form__search-wpr'>\n        <input\n          className='form__input'\n          type='text'\n          placeholder='Search album or artist'\n          ref={inputRef}\n        />\n        <button className='form__btn'>Search</button>\n      </div>\n\n      <div className='form__sort-wpr'>\n        <label htmlFor='form__sort'>Sort By:</label>\n        <select id='form__sort' name='sort' onChange={handleChange}>\n          <option value=''>Default</option>\n          <option value='name'>Album name</option>\n          <option value='artist_name'>Artist name</option>\n          <option value='release_date'>Release Date</option>\n          <option value='popularity'>Popularity</option>\n        </select>\n      </div>\n\n      <div className='form__filter-wpr'>\n        <label htmlFor='form__filter'>Filter By:</label>\n        <select id='form__filter' name='filter' onChange={handleChange}>\n          <option value=''>Any time</option>\n          <option value={currentYear}>Past year</option>\n          <option value={`${currentYear - 1}-${currentYear}`}>\n            Past 2 years\n          </option>\n          <option value={`${currentYear - 4}-${currentYear}`}>\n            Past 5 years\n          </option>\n        </select>\n      </div>\n    </form>\n  );\n};\n\nexport default SearchForm;\n","export const encodeSpaces = (str) => str.replaceAll(' ', '+'); // not necessary!\nexport const supportUnicodeText = (str) =>\n  decodeURIComponent(JSON.parse('\"' + str.replace(/\"/g, '\\\\\"') + '\"'));\n\nexport const sortByKey = (array, key, isReversed) => {\n  //   console.log('unsorted arr: ', array);\n  return array.slice().sort((a, b) => {\n    const x = a[key];\n    const y = b[key];\n    if (isReversed) {\n      return x > y ? -1 : x < y ? 1 : 0;\n    }\n    return x < y ? -1 : x > y ? 1 : 0;\n  });\n};\n\n// function sortByKey(array, key) {\n//   return array.sort(function (a, b) {\n//     var x = a[key];\n//     var y = b[key];\n//     return x < y ? -1 : x > y ? 1 : 0;\n//   });\n// }\n\nexport const chooseRelevantItemData = (items) =>\n  items.map(\n    ({ id, name, track_number, popularity, preview_url, album, artists }) => ({\n      id,\n      name,\n      track_number,\n      popularity,\n      preview_url,\n      album_img: album.images[0].url,\n      release_date: album.release_date,\n      artist_name: artists[0].name,\n    })\n  );\n","import { sortByKey } from '../utils/helper';\n\nconst Results = ({ data, sortBy, isLoading, onFetchMore }) => {\n  const isReverseSort = ['popularity', 'release_date'].includes(sortBy);\n\n  return (\n    <>\n      {data.error && (\n        <p className='error'>\n          It looks like there was a {data.error?.status || ''} network error...\n          since: \"{data.error.message}\"\n        </p>\n      )}\n      {isLoading && <div className='loading'>Loading...</div>}\n      {data?.items?.length > 0 && (\n        <div>\n          <div className='albums-count sticky'>{data.total} Results found</div>\n          <ul className='albums'>\n            {console.log('data: ', data)}\n\n            {sortByKey(data.items, sortBy, isReverseSort).map(\n              ({\n                id,\n                name,\n                track_number,\n                popularity,\n                preview_url,\n                release_date,\n                artist_name,\n                album_img,\n              }) => (\n                <li className='album' key={id}>\n                  <img\n                    className='album__img'\n                    alt={name}\n                    loading='lazy'\n                    src={album_img}\n                  />\n                  <audio className='album__audio' controls src={preview_url}>\n                    Your browser does not support the\n                    <code>audio</code> element.\n                  </audio>\n                  <dl className='album__content'>\n                    <div>\n                      <dt>Artist name</dt>\n                      <dd>{artist_name}</dd>\n                    </div>\n                    <div>\n                      <dt>Album Name</dt>\n                      <dd>{name}</dd>\n                      <dd className='album__track'>track #{track_number}</dd>\n                    </div>\n                    <div>\n                      <dt>Release Date</dt>\n                      <dd>{release_date}</dd>\n                    </div>\n                    <div>\n                      <dt>Popularity</dt>\n                      <dd>{popularity}</dd>\n                    </div>\n                  </dl>\n                </li>\n              )\n            )}\n          </ul>\n          {data.next !== null && (\n            <button\n              className={`btn--primary ${isLoading ? 'loading' : ''}`}\n              type='button'\n              onClick={() => {\n                onFetchMore(data.next);\n              }}\n            >\n              Load more albums\n            </button>\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default Results;\n","import './App.css';\nimport React, { useState, useEffect } from 'react';\nimport SearchForm from './components/SearchForm';\nimport Results from './components/Results';\nimport Cookies from 'js-cookie';\nimport { SpotifyAuth, Scopes } from 'react-spotify-auth';\n// import { BrowserRouter as Router, Route, Redirect } from 'react-router-dom';\nimport {\n  encodeSpaces,\n  supportUnicodeText,\n  chooseRelevantItemData,\n} from './utils/helper';\n\n// import useFetch from './hooks/useFetch'; // had an authentication problem here :(\n\nconst App = () => {\n  const token = Cookies.get('spotifyAuthToken');\n  const [url, setUrl] = useState('');\n  const [data, setData] = useState({});\n  const [sortBy, setSortBy] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n\n  useEffect(() => {\n    if (!url) return;\n    const headers = {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${token}`,\n    };\n    console.log('url: ', url);\n\n    const getData = async () => {\n      setIsLoading(true);\n      const res = await fetch(url, { headers });\n      const json = await res.json();\n      setIsLoading(false);\n      console.log('setting data...', json);\n      if (json.error !== undefined) {\n        setData(json);\n        return;\n      }\n\n      setData((prev) => {\n        if (json.tracks.offset === 0) {\n          // hit a new request\n          return {\n            href: json.tracks.href,\n            total: json.tracks.total,\n            next: json.tracks.next,\n            previous: json.tracks.previous,\n            items: [...chooseRelevantItemData(json.tracks.items)],\n          };\n        } else {\n          return {\n            ...prev,\n            next: json.tracks.next,\n            items: [\n              ...prev.items,\n              ...chooseRelevantItemData(json.tracks.items),\n            ],\n          };\n        }\n      });\n    };\n    getData();\n  }, [url, token]);\n\n  const onFormSubmit = (input) => {\n    const yearRange = input.filter ? `+year:${input.filter}` : '';\n    const url = `https://api.spotify.com/v1/search?query=${encodeSpaces(\n      supportUnicodeText(input.text)\n    )}${yearRange}&type=track&market=US`;\n    console.log('url: ', url);\n    sortBy && setSortBy(sortBy); // sortBy is '' by default\n    setUrl(url);\n  };\n  const onSort = (value) => {\n    // console.log('sort: ', value);\n    setSortBy(value);\n  };\n\n  const onFetchMore = (url) => {\n    setUrl(url);\n  };\n\n  return (\n    // <Router>\n    //   <Route path='/spotify-search/callback'>\n    //     <Redirect to='/spotify-search' />\n    //   </Route>\n    //   <Route path='/spotify-search'>\n\n    //   </Route>\n    // </Router>\n    <main className={`app ${data?.items?.length > 0 ? 'has-data' : ''}`}>\n      <h1 className='search-header sticky'>\n        <span aria-hidden='true'>\n          Sp<span className='icon-logo'>o</span>tify\n        </span>\n        <span className='offscreen'>Spotify</span>\n        <span className='icon-search'>Search</span>\n      </h1>\n\n      <SearchForm onFormSubmit={onFormSubmit} onSort={onSort} />\n      {token ? (\n        <Results\n          data={data}\n          sortBy={sortBy}\n          isLoading={isLoading}\n          onFetchMore={onFetchMore}\n        />\n      ) : (\n        // Display the login page\n        <SpotifyAuth\n          redirectUri='https://danield770.github.io/spotify-search/callback'\n          clientID={process.env.REACT_APP_CLIENT_ID}\n          scopes={[Scopes.userReadPrivate, 'user-read-email']} // either style will work\n        />\n      )}\n    </main>\n  );\n};\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}