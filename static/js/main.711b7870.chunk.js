(this["webpackJsonpspotify-search"]=this["webpackJsonpspotify-search"]||[]).push([[0],{19:function(e,t,a){},21:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var r=a(1),c=a.n(r),n=a(12),s=a.n(n),i=(a(19),a(9)),o=a.n(i),l=a(10),u=a(7),d=a(13),j=a(4),b=(a(21),a(5)),m=a(0),h=function(e){var t=e.onFormSubmit,a=e.onSort,c=Object(r.useRef)(),n=(new Date).getFullYear(),s=function(e){var r=e.target,n=r.value;if(console.log("selected: ",r.name,n),"sort"===r.name)a(n);else{var s=Object(b.a)({text:c.current.value},r.name,n);t(s)}};return Object(m.jsxs)("form",{className:"form sticky",onSubmit:function(e){e.preventDefault();var a={text:c.current.value};t(a)},children:[Object(m.jsxs)("div",{className:"form__search-wpr",children:[Object(m.jsx)("input",{className:"form__input",type:"text",placeholder:"Search album or artist",ref:c}),Object(m.jsx)("button",{className:"form__btn",children:"Search"})]}),Object(m.jsxs)("div",{className:"form__sort-wpr",children:[Object(m.jsx)("label",{htmlFor:"form__sort",children:"Sort By:"}),Object(m.jsxs)("select",{id:"form__sort",name:"sort",onChange:s,children:[Object(m.jsx)("option",{value:"",children:"Default"}),Object(m.jsx)("option",{value:"name",children:"Album name"}),Object(m.jsx)("option",{value:"artist_name",children:"Artist name"}),Object(m.jsx)("option",{value:"release_date",children:"Release Date"}),Object(m.jsx)("option",{value:"popularity",children:"Popularity"})]})]}),Object(m.jsxs)("div",{className:"form__filter-wpr",children:[Object(m.jsx)("label",{htmlFor:"form__filter",children:"Filter By:"}),Object(m.jsxs)("select",{id:"form__filter",name:"filter",onChange:s,children:[Object(m.jsx)("option",{value:"",children:"Any time"}),Object(m.jsx)("option",{value:n,children:"Past year"}),Object(m.jsx)("option",{value:"".concat(n-1,"-").concat(n),children:"Past 2 years"}),Object(m.jsx)("option",{value:"".concat(n-4,"-").concat(n),children:"Past 5 years"})]})]})]})},p=function(e){return e.map((function(e){var t=e.id,a=e.name,r=e.track_number,c=e.popularity,n=e.preview_url,s=e.album,i=e.artists;return{id:t,name:a,track_number:r,popularity:c,preview_url:n,album_img:s.images[0].url,release_date:s.release_date,artist_name:i[0].name}}))},O=function(e){var t,a,r,c,n,s=e.data,i=e.sortBy,o=e.isLoading,l=e.onFetchMore,u=["popularity","release_date"].includes(i);return Object(m.jsxs)(m.Fragment,{children:[s.error&&Object(m.jsxs)("p",{className:"error",children:["It looks like there was a ",(null===(t=s.error)||void 0===t?void 0:t.status)||"",' network error... since: "',s.error.message,'"']}),o&&Object(m.jsx)("div",{className:"loading",children:"Loading..."}),(null===s||void 0===s||null===(a=s.items)||void 0===a?void 0:a.length)>0&&Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"albums-count sticky",children:[s.total," Results found"]}),Object(m.jsxs)("ul",{className:"albums",children:[console.log("data: ",s),(r=s.items,c=i,n=u,r.slice().sort((function(e,t){var a=e[c],r=t[c];return n?a>r?-1:a<r?1:0:a<r?-1:a>r?1:0}))).map((function(e){var t=e.id,a=e.name,r=e.track_number,c=e.popularity,n=e.preview_url,s=e.release_date,i=e.artist_name,o=e.album_img;return Object(m.jsxs)("li",{className:"album",children:[Object(m.jsx)("img",{className:"album__img",alt:a,loading:"lazy",src:o}),Object(m.jsxs)("audio",{className:"album__audio",controls:!0,src:n,children:["Your browser does not support the",Object(m.jsx)("code",{children:"audio"})," element."]}),Object(m.jsxs)("dl",{className:"album__content",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Artist name"}),Object(m.jsx)("dd",{children:i})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Album Name"}),Object(m.jsx)("dd",{children:a}),Object(m.jsxs)("dd",{className:"album__track",children:["track #",r]})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Release Date"}),Object(m.jsx)("dd",{children:s})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Popularity"}),Object(m.jsx)("dd",{children:c})]})]})]},t)}))]}),null!==s.next&&Object(m.jsx)("button",{className:"btn--primary ".concat(o?"loading":""),type:"button",onClick:function(){l(s.next)},children:"Load more albums"})]})]})},f=a(14),x=a.n(f),v=a(11),_=function(){var e,t=x.a.get("spotifyAuthToken"),a=Object(r.useState)(""),c=Object(j.a)(a,2),n=c[0],s=c[1],i=Object(r.useState)({}),b=Object(j.a)(i,2),f=b[0],_=b[1],g=Object(r.useState)(""),y=Object(j.a)(g,2),k=y[0],N=y[1],S=Object(r.useState)(!1),w=Object(j.a)(S,2),F=w[0],A=w[1];Object(r.useEffect)((function(){if(n){var e={"Content-Type":"application/json",Authorization:"Bearer ".concat(t)};console.log("url: ",n),function(){var t=Object(d.a)(o.a.mark((function t(){var a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return A(!0),t.next=3,fetch(n,{headers:e});case 3:return a=t.sent,t.next=6,a.json();case 6:if(r=t.sent,A(!1),console.log("setting data...",r),void 0===r.error){t.next=12;break}return _(r),t.abrupt("return");case 12:_((function(e){return 0===r.tracks.offset?{href:r.tracks.href,total:r.tracks.total,next:r.tracks.next,previous:r.tracks.previous,items:Object(u.a)(p(r.tracks.items))}:Object(l.a)(Object(l.a)({},e),{},{next:r.tracks.next,items:[].concat(Object(u.a)(e.items),Object(u.a)(p(r.tracks.items)))})}));case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}}),[n,t]);return Object(m.jsxs)("main",{className:"app ".concat((null===f||void 0===f||null===(e=f.items)||void 0===e?void 0:e.length)>0?"has-data":""),children:[Object(m.jsxs)("h1",{className:"search-header sticky",children:[Object(m.jsxs)("span",{"aria-hidden":"true",children:["Sp",Object(m.jsx)("span",{className:"icon-logo",children:"o"}),"tify"]}),Object(m.jsx)("span",{className:"offscreen",children:"Spotify"}),Object(m.jsx)("span",{className:"icon-search",children:"Search"})]}),Object(m.jsx)(h,{onFormSubmit:function(e){var t,a=e.filter?"+year:".concat(e.filter):"",r="https://api.spotify.com/v1/search?query=".concat(function(e){return e.replaceAll(" ","+")}((t=e.text,decodeURIComponent(JSON.parse('"'+t.replace(/"/g,'\\"')+'"'))))).concat(a,"&type=track&market=US");console.log("url: ",r),k&&N(k),s(r)},onSort:function(e){N(e)}}),t?Object(m.jsx)(O,{data:f,sortBy:k,isLoading:F,onFetchMore:function(e){s(e)}}):Object(m.jsx)(v.b,{redirectUri:"http://localhost:3000/callback",clientID:"405281f84e1b47808864d0cbf83a9c1e",scopes:[v.a.userReadPrivate,"user-read-email"]})]})},g=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,26)).then((function(t){var a=t.getCLS,r=t.getFID,c=t.getFCP,n=t.getLCP,s=t.getTTFB;a(e),r(e),c(e),n(e),s(e)}))};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(_,{})}),document.getElementById("root")),g()}},[[25,1,2]]]);
//# sourceMappingURL=main.711b7870.chunk.js.map