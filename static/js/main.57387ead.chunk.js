(this["webpackJsonpspotify-search"]=this["webpackJsonpspotify-search"]||[]).push([[0],{31:function(e,t,a){},33:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var c=a(1),r=a.n(c),n=a(21),s=a.n(n),i=(a(31),a(16)),o=a.n(i),l=a(17),u=a(13),d=a(22),j=a(10),b=(a(33),a(11)),m=a(0),h=function(e){var t=e.onFormSubmit,a=e.onSort,r=Object(c.useRef)(),n=(new Date).getFullYear(),s=function(e){var c=e.target,n=c.value;if(console.log("selected: ",c.name,n),"sort"===c.name)a(n);else{var s=Object(b.a)({text:r.current.value},c.name,n);t(s)}};return Object(m.jsxs)("form",{className:"form sticky",onSubmit:function(e){e.preventDefault();var a={text:r.current.value};t(a)},children:[Object(m.jsxs)("div",{className:"form__search-wpr",children:[Object(m.jsx)("input",{className:"form__input",type:"text",placeholder:"Search album or artist",ref:r}),Object(m.jsx)("button",{className:"form__btn",children:"Search"})]}),Object(m.jsxs)("div",{className:"form__sort-wpr",children:[Object(m.jsx)("label",{htmlFor:"form__sort",children:"Sort By:"}),Object(m.jsxs)("select",{id:"form__sort",name:"sort",onChange:s,children:[Object(m.jsx)("option",{value:"",children:"Default"}),Object(m.jsx)("option",{value:"name",children:"Album name"}),Object(m.jsx)("option",{value:"artist_name",children:"Artist name"}),Object(m.jsx)("option",{value:"release_date",children:"Release Date"}),Object(m.jsx)("option",{value:"popularity",children:"Popularity"})]})]}),Object(m.jsxs)("div",{className:"form__filter-wpr",children:[Object(m.jsx)("label",{htmlFor:"form__filter",children:"Filter By:"}),Object(m.jsxs)("select",{id:"form__filter",name:"filter",onChange:s,children:[Object(m.jsx)("option",{value:"",children:"Any time"}),Object(m.jsx)("option",{value:n,children:"Past year"}),Object(m.jsx)("option",{value:"".concat(n-1,"-").concat(n),children:"Past 2 years"}),Object(m.jsx)("option",{value:"".concat(n-4,"-").concat(n),children:"Past 5 years"})]})]})]})},p=function(e){return e.map((function(e){var t=e.id,a=e.name,c=e.track_number,r=e.popularity,n=e.preview_url,s=e.album,i=e.artists;return{id:t,name:a,track_number:c,popularity:r,preview_url:n,album_img:s.images[0].url,release_date:s.release_date,artist_name:i[0].name}}))},O=function(e){var t,a,c,r,n,s=e.data,i=e.sortBy,o=e.isLoading,l=e.onFetchMore,u=["popularity","release_date"].includes(i);return Object(m.jsxs)(m.Fragment,{children:[s.error&&Object(m.jsxs)("p",{className:"error",children:["It looks like there was a ",(null===(t=s.error)||void 0===t?void 0:t.status)||"",' network error... since: "',s.error.message,'"']}),o&&Object(m.jsx)("div",{className:"loading",children:"Loading..."}),(null===s||void 0===s||null===(a=s.items)||void 0===a?void 0:a.length)>0&&Object(m.jsxs)("div",{children:[Object(m.jsxs)("div",{className:"albums-count sticky",children:[s.total," Results found"]}),Object(m.jsxs)("ul",{className:"albums",children:[console.log("data: ",s),(c=s.items,r=i,n=u,c.slice().sort((function(e,t){var a=e[r],c=t[r];return n?a>c?-1:a<c?1:0:a<c?-1:a>c?1:0}))).map((function(e){var t=e.id,a=e.name,c=e.track_number,r=e.popularity,n=e.preview_url,s=e.release_date,i=e.artist_name,o=e.album_img;return Object(m.jsxs)("li",{className:"album",children:[Object(m.jsx)("img",{className:"album__img",alt:a,loading:"lazy",src:o}),Object(m.jsxs)("audio",{className:"album__audio",controls:!0,src:n,children:["Your browser does not support the",Object(m.jsx)("code",{children:"audio"})," element."]}),Object(m.jsxs)("dl",{className:"album__content",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Artist name"}),Object(m.jsx)("dd",{children:i})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Album Name"}),Object(m.jsx)("dd",{children:a}),Object(m.jsxs)("dd",{className:"album__track",children:["track #",c]})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Release Date"}),Object(m.jsx)("dd",{children:s})]}),Object(m.jsxs)("div",{children:[Object(m.jsx)("dt",{children:"Popularity"}),Object(m.jsx)("dd",{children:r})]})]})]},t)}))]}),null!==s.next&&Object(m.jsx)("button",{className:"btn--primary ".concat(o?"loading":""),type:"button",onClick:function(){l(s.next)},children:"Load more albums"})]})]})},f=a(23),x=a.n(f),v=a(18),_=a(24),y=a(2),g=function(){var e,t=x.a.get("spotifyAuthToken"),a=Object(c.useState)(""),r=Object(j.a)(a,2),n=r[0],s=r[1],i=Object(c.useState)({}),b=Object(j.a)(i,2),f=b[0],g=b[1],k=Object(c.useState)(""),N=Object(j.a)(k,2),S=N[0],w=N[1],F=Object(c.useState)(!1),A=Object(j.a)(F,2),C=A[0],P=A[1];Object(c.useEffect)((function(){if(n){var e={"Content-Type":"application/json",Authorization:"Bearer ".concat(t)};console.log("url: ",n),function(){var t=Object(d.a)(o.a.mark((function t(){var a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,fetch(n,{headers:e});case 3:return a=t.sent,t.next=6,a.json();case 6:if(c=t.sent,P(!1),console.log("setting data...",c),void 0===c.error){t.next=12;break}return g(c),t.abrupt("return");case 12:g((function(e){return 0===c.tracks.offset?{href:c.tracks.href,total:c.tracks.total,next:c.tracks.next,previous:c.tracks.previous,items:Object(u.a)(p(c.tracks.items))}:Object(l.a)(Object(l.a)({},e),{},{next:c.tracks.next,items:[].concat(Object(u.a)(e.items),Object(u.a)(p(c.tracks.items)))})}));case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}}),[n,t]);return Object(m.jsx)(_.a,{children:Object(m.jsx)(y.a,{path:"/spotify-search/",children:Object(m.jsxs)("main",{className:"app ".concat((null===f||void 0===f||null===(e=f.items)||void 0===e?void 0:e.length)>0?"has-data":""),children:[Object(m.jsxs)("h1",{className:"search-header sticky",children:[Object(m.jsxs)("span",{"aria-hidden":"true",children:["Sp",Object(m.jsx)("span",{className:"icon-logo",children:"o"}),"tify"]}),Object(m.jsx)("span",{className:"offscreen",children:"Spotify"}),Object(m.jsx)("span",{className:"icon-search",children:"Search"})]}),Object(m.jsx)(h,{onFormSubmit:function(e){var t,a=e.filter?"+year:".concat(e.filter):"",c="https://api.spotify.com/v1/search?query=".concat(function(e){return e.replaceAll(" ","+")}((t=e.text,decodeURIComponent(JSON.parse('"'+t.replace(/"/g,'\\"')+'"'))))).concat(a,"&type=track&market=US");console.log("url: ",c),S&&w(S),s(c)},onSort:function(e){w(e)}}),t?Object(m.jsx)(O,{data:f,sortBy:S,isLoading:C,onFetchMore:function(e){s(e)}}):Object(m.jsx)(v.b,{redirectUri:"https://danield770.github.io/spotify-search/callback",clientID:"405281f84e1b47808864d0cbf83a9c1e",scopes:[v.a.userReadPrivate,"user-read-email"]})]})})})},k=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,41)).then((function(t){var a=t.getCLS,c=t.getFID,r=t.getFCP,n=t.getLCP,s=t.getTTFB;a(e),c(e),r(e),n(e),s(e)}))};s.a.render(Object(m.jsx)(r.a.StrictMode,{children:Object(m.jsx)(g,{})}),document.getElementById("root")),k()}},[[40,1,2]]]);
//# sourceMappingURL=main.57387ead.chunk.js.map